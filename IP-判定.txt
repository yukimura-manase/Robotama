

[ Apacheで接続元IPを判定したり、IP 制限をしたりする方法 (.htaccess) ]


<IfModule mod_rewrite.c>

RewriteEngine on
RewriteBase /

### ここから IP アドレス制限、アクセス許可するのIPの設定 ###

# 接続元IPを判定する => ロードバランサーを考慮して、X-Forwarded-For をCheckします
RewriteCond ,%{REMOTE_ADDR},%{HTTP:X-Forwarded-For}, ,!153\.151\.3\.177,
RewriteCond ,%{REMOTE_ADDR},%{HTTP:X-Forwarded-For}, ,!220\.148\.222\.155,

# dashboard & manual にAccessできるIPは制限します
RewriteRule ^(dashboard|index.php/dashboard|manual|index.php/manual)(.*) - [F]
### ここまで IPアドレス制限の設定 ###

    
</IfModule>


1. IP 制限を行う

    一般的な Apache サーバーで、.htaccess の編集ができるのであれば、
    ログインできるページに特定の IP のみにアクセス許可するよう設定できます。

        ##  -- concrete5 urls start --

        RewriteEngine On
        RewriteBase /
        # concrete5 がサブディレクトリにインストールされていたら、RewriteBase の変更が必要です。

        # ここから IP アドレス制限、アクセス許可するのIPの設定
        RewriteCond %{REMOTE_ADDR} !123\.4\.56\.789
        RewriteCond %{REMOTE_ADDR} !123\.123\.123\.123
        # もっとIPがある場合は、行を追加してください
        RewriteRule ^(dashboard|index.php/dashboard|login|index.php/login)(.*) - [F]
        # ここまで IPアドレス制限の設定

        RewriteCond %{REQUEST_FILENAME} !-f
        RewriteCond %{REQUEST_FILENAME}/index.html !-f
        RewriteCond %{REQUEST_FILENAME}/index.php !-f
        RewriteRule . index.php [L]

        # -- concrete5 urls end --


    元ネタ by Hissy
    https://gist.github.com/hissy/5433792



IP 制限を行う
https://macareux.co.jp/blog/concrete5-access-restriction



接続元IPを判定するRewriteCondでよくやる奴メモ（Proxy考慮）
https://qiita.com/kawaz/items/76151c7cfdf598c25409
